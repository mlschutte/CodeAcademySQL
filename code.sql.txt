  --Quiz Funnel select * from survey limit 10;  --how many ppl @ each question of survey select question, count(distinct user_id) from survey group by 1; select * from quiz limit 5; select * from home_try_on limit 5; select * from purchase limit 5;select distinct q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'from quiz qleft join home_try_on hon q.user_id = h.user_idleft join purchase pon p.user_id = q.user_idlimit 10;with results as (select distinct q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'from quiz qleft join home_try_on hon q.user_id = h.user_idleft join purchase pon p.user_id = q.user_id                )SELECT is_purchase,  COUNT(DISTINCT CASE    WHEN number_of_pairs = '3 pairs' THEN user_id    END) AS '3 Pairs',   COUNT(distinct case when number_of_pairs='5 pairs' then 			user_id end) as '5 Pairs'FROM resultsgroup by 1;select count(distinct user_id) from quiz;select distinct q.user_id, h.user_id is not null as 'to_home_try_on',  p.user_id is not null as 'to_puchase'  from quiz as 'q' left join home_try_on as 'h' on h.user_id=q.user_id left join purchase as 'p' on p.user_id=h.user_id limit 20;WITH funnels AS ( select distinct q.user_id, h.user_id is not null as 'to_home_try_on',  p.user_id is not null as 'to_puchase'  from quiz as 'q' left join home_try_on as 'h' on h.user_id=q.user_id left join purchase as 'p' on p.user_id=h.user_id)SELECT count(*) as 'num_quiz', sum(to_home_try_on) as 'num_home', sum(to_puchase) as 'num_purchase', 1.0 * SUM(to_home_try_on) / COUNT(user_id) as 'percent to try on at home',1.0 * SUM(to_puchase) / SUM(to_home_try_on) as 'percent of purchases from those who brought home'from funnels;WITH threeorfive AS(select distinct h.user_id,  h.number_of_pairs as 'num'from home_try_on as 'h'left join purchase as 'p'on p.user_id = h.user_id)--select count(*) as 'num_tryon&purch',--sum(h.number_of_pairs) as ''select num, count(*) as 'total_purch'from threeorfivegroup by num;select distinct model_name from purchase;select distinct model_name, style, price from purchase where style like 'Women%'order by 1 asc limit 20;select distinct model_name, style, price from purchase where style like 'Men%'order by 1 asc limit 20;select model_name, count(model_name), style, price from purchasegroup by 1order by 2 desclimit 10;select style, avg(price)from purchase group by 1;